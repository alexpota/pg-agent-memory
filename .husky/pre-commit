# Fast fail on type errors first
echo "ğŸ” Running TypeScript type check..."
npm run type-check

# Run lint-staged for efficient validation of changed files
echo "âœ¨ Running lint-staged..."
npx lint-staged

# Run unit tests (always)
echo "ğŸ§ª Running unit tests..."
npm run test

# Run integration tests if DATABASE_URL is available
if [ ! -z "$DATABASE_URL" ]; then
  echo "ğŸ”— DATABASE_URL detected, running integration tests..."
  npm run test:integration
else
  echo "âš ï¸  No DATABASE_URL - skipping integration tests (may fail in CI)"
  echo "   Set DATABASE_URL to catch integration issues locally"
fi